{"version":3,"sources":["modules/City.js"],"names":["cities","City","node","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","parkedCars","charge","name","cityDict","id","type","push","target","length","pop","driveTo","find","car","capacity","environment","simulation","carChargeLimit","difference","total","i","updateAverageCharge","getChargePercentage","driveHome","fill","noStroke","chargeToColor","ellipse","x","scale","y","render","Node"],"mappings":"43BAAIA,UAEEC,iBACF,SAAAA,EAAYC,GAAMC,gBAAAC,KAAAH,GAAA,IAAAI,EAAAC,2BAAAF,MAAAH,EAAAM,WAAAC,OAAAC,eAAAR,IAAAS,KAAAN,KACRF,IADQ,OAGdG,EAAKM,cACLN,EAAKO,OAAS,EACdP,EAAKQ,KAAOC,SAAST,EAAKU,IAC1BV,EAAKW,KAAO,OAEZhB,OAAOiB,KAAPZ,GARcA,wEAWRa,GAXVd,KAAAO,WAAkBQ,QAgBJf,KAAKO,WAAWS,MAX1BC,QAAAH,2CALc,OAAAd,KAAAO,WAAAW,KAAA,SAAAC,GASjB,OAAAA,EAAAX,OAAAW,EAAAC,SAAAC,YAAAC,WAAAC,6DAmBmBC,GAhBhBxB,KAAGO,WAAMA,OACLP,KAAAQ,OAAAR,KAAAQ,QAAAgB,EAAAxB,KAAAQ,QAAAR,KAAAO,WAAAQ,OAmBAf,KAAKQ,OAAS,mDAZrB,IAAAiB,EAAA,EAmBG,IAAI,IAAIC,KAAK1B,KAAKO,WAAY,CAC1B,IAAIY,EAAMnB,KAAKO,WAAWmB,GAhB1BD,GAAAN,EAAOA,OAAAA,EAAaA,SAqBxBnB,KAAKQ,OAASiB,EAAQzB,KAAKO,WAAWQ,6CAflC,GAAAf,KAAAO,WAAAQ,OAAA,CAIP,IAAAI,EAAAnB,KAAAO,WAAAS,MAqBGhB,KAAK2B,oBAAoBR,EAAIS,uBAC7BT,EAAIU,8CAhBAC,KAAA,IAqBJC,WAnBIN,KAAAA,WAASN,QACZW,KAAAE,cAAAhC,KAAAQ,SAGJ,aAAAR,KAAAS,KAqBOwB,QAAQjC,KAAKkC,EAAIb,YAAYc,MAAOnC,KAAKoC,EAAIf,YAAYc,MAAO,GAAKd,YAAYc,MAAO,GAAKd,YAAYc,OAEzGF,QAAQjC,KAAKkC,EAAIb,YArBXc,MAAAnC,KAAAoC,EAAAf,YAAAc,MAAA,GAAAd,YAAAc,MAAA,GAAAd,YAAAc,wCA2BVnC,KAAKqC,gBA5EMC","file":"City.js","sourcesContent":["var cities = [];\n\nclass City extends Node {\n    constructor(node) {\n        super(node)\n\n        this.parkedCars = [];\n        this.charge = 1\n        this.name = cityDict[this.id]\n        this.type = 'city'\n\n        cities.push(this)\n    }\n\n    sendCarTo(target) {\n        if(!this.parkedCars.length) {\n            return\n        }\n\n        var car = this.parkedCars.pop()\n\n        // this.updateAverageCharge(car.getChargePercentage())\n        car.driveTo(target)\n    }\n\n    needsCharging() {\n        return this.parkedCars.find(function(car) {\n            return car.charge / car.capacity < environment.simulation.carChargeLimit\n        })\n    }\n\n    updateAverageCharge(difference) {\n        if(this.parkedCars.length) {\n            this.charge = this.charge + (difference - this.charge) / this.parkedCars.length\n        } else {\n            this.charge = 1\n        }\n    }\n\n    calculateAverageCharge() {\n        var total = 0;\n\n        for(var i in this.parkedCars) {\n            var car = this.parkedCars[i];\n\n            total += car.charge / car.capacity\n        }\n\n        this.charge = total / this.parkedCars.length\n    }\n\n    sendCarHome() {\n        if(!this.parkedCars.length) {\n            return\n        }\n\n        var car = this.parkedCars.pop()\n\n        this.updateAverageCharge(car.getChargePercentage())\n        car.driveHome()\n    }\n\n    render() {\n        fill(20)\n        noStroke()\n        if(this.parkedCars.length) {\n            fill(chargeToColor(this.charge))\n        }\n\n        if(this.name == 'Stuttgart') {\n            ellipse(this.x * environment.scale, this.y * environment.scale, 35 * environment.scale, 35 * environment.scale)\n        } else {\n            ellipse(this.x * environment.scale, this.y * environment.scale, 20 * environment.scale, 20 * environment.scale)\n        }\n\n    }\n\n    update() {\n        this.render();\n    }\n}\n"]}