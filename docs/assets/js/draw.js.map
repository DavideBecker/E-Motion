{"version":3,"sources":["draw.js"],"names":["draw","clear","backgroundBrightness","environment","dayDuration","brightDir","grey","constrain","background","daytime","carIndex","cars","length","car","update","truckIndex","trucks","truck","cityIndex","cities","city","Events","id","cityDict","Stuttgart","dt","sendCarTo","Nodes","getByName","isActive","sendCarHome","evnt","eventType","eventTimes","event","start","end","fill","Math","round","startOfWorkday","endOfWorkday","timer","debugMagic"],"mappings":"aAAA,SAASA,OACLC,QAAAA,IAAAA,EAAAA,MAAAA,YAAAA,YAEAC,qBAAiBC,UAAYC,qBAA7BC,UAAA,EAAA,KAGA,IAAIC,EAAOC,UAAUL,qBAAsB,EAAG,KAA9CM,WAAWD,IAAAA,EAAAA,EAAUL,IAErBM,YAAWC,QAAQH,EAAMH,YAAzBC,YAIA,IAAA,IAAAM,EAAA,EAAAA,EAAAC,KAAAC,OAAAF,IAGcC,KAAKD,GAAXG,SAEJA,IAAAA,IAAIC,EAAJ,EAAAC,EAAAC,OAAAJ,OAAAG,IACHC,OAAAD,GAEOE,SAEJA,IAAAA,IAAAA,EAAA,EAAAC,EAAAC,OAAAP,OAAAM,IAAA,CACH,IAAAE,EAAAD,OAAAD,GAEGG,OAAID,SAAcF,mBAAlBE,EAAAE,IAAAC,SAAAC,WAAAC,EAAA,GAAA,GAGIL,EAAKM,UAAUC,MAAMC,UAAU,cAClCP,OAAAQ,SAAA,iBAAAT,EAAAE,IAAAC,SAAAC,WAAAC,EAAA,GAAA,GAGGL,EAAKU,cAITV,EAAKN,SAGT,IAAIiB,EAAO,EAEX,IAAI,IAAIC,KAAaC,WAAY,CAAjC,IAAIC,EAAIF,WAAaC,GAGdR,GAAMS,EAAMC,QAAZV,OAAMS,OAAMC,GAGK,eAAbH,GAAAA,OAAAA,QAAa,qBAKjBP,GAAMS,EAAME,MAAZX,OAAMS,QAATF,GAGoB,eAAbA,GAAAA,OAAAA,QAAa,mBAKpBK,KAAK,IAILN,GAAQ,EAGTN,GAAMa,KAAKC,MAAMN,WAAWO,eAAeL,MAAQ,IAAnDV,OAAMa,QAAKC,YAIXd,GAAMa,KAAKC,MAAMN,WAAWQ,aAAaN,MAAQhC,YAAYC,YAAc,KAA3EqB,OAAMa,QAAKC,cAIdG,OAAS,EAMTC","file":"draw.js","sourcesContent":["function draw() {\n    clear()\n\n    var dt = timer % environment.dayDuration;\n\n    backgroundBrightness = constrain(backgroundBrightness + brightDir, 0, 255)\n    var grey = constrain(backgroundBrightness, 0, 255)\n\n    background(255, 0, grey, 0.5)\n\n    environment.daytime = dt / environment.dayDuration;\n\n    // console.log(environment.daytime)\n\n    for(var carIndex = 0; carIndex < cars.length; carIndex++) {\n        var car = cars[carIndex];\n\n        car.update()\n    }\n    for(var truckIndex = 0; truckIndex < trucks.length; truckIndex++) {\n        var truck = trucks[truckIndex];\n\n        truck.update()\n    }\n    for(var cityIndex = 0; cityIndex < cities.length; cityIndex++) {\n        var city = cities[cityIndex];\n\n        if(Events.isActive('startOfWorkday') && city.id != cityDict.Stuttgart && dt % 10 < 1) {\n            city.sendCarTo(Nodes.getByName('Stuttgart'))\n        }\n\n        if(Events.isActive('endOfWorkday') && city.id == cityDict.Stuttgart && dt % 10 < 1) {\n            city.sendCarHome()\n        }\n\n\n        city.update()\n    }\n\n    var evnt = 0;\n\n    for(var eventType in eventTimes) {\n        var event = eventTimes[eventType]\n\n        if(dt == event.start) {\n            Events.enable(eventType)\n\n            if(eventType == 'nightCharge') {\n                Events.trigger('nightChargeStart')\n            }\n        }\n\n        if(dt == event.end) {\n            Events.disable(eventType)\n\n            if(eventType == 'nightCharge') {\n                Events.trigger('nightChargeEnd')\n            }\n        }\n\n        fill(51)\n\n        // text(eventType + ' - ' + Events.isActive(eventType), 100, 100 + 20 * evnt)\n\n        evnt += 1\n    }\n\n    if(dt == Math.round(eventTimes.startOfWorkday.start / 2)) {\n        Events.trigger('nightEnd')\n    }\n\n    if(dt == Math.round(eventTimes.endOfWorkday.start + environment.dayDuration / 20)) {\n        Events.trigger('nightStart')\n    }\n\n    timer += 1;\n\n    // renderAllNodes()\n\n    // showPathFor(trucks[0])\n\n    debugMagic();\n}\n"]}