{"version":3,"sources":["setup.js"],"names":["queue","timer","daytimeCycle","backgroundBrightness","brightDir","staticMap","p5","renderMap","setup","frameRate","colorMode","HSB","rectMode","CENTER","noStroke","canvas","createCanvas","parent","resize","window","carIndex","environment","simulation","carAmount","car","Car","charge","capacity","carChargeLimit","enteredCity","home","totalCarCharge","isSlacker","Math","random","truckIndex","truckAmount","Truck","console","table","cars","trucks","Events","on","wroom","pos","findIndex","elem","type","length","splice","city","push","cityIndex","cities","needsCharging","id","cityDict","Stuttgart","trigger","filter","item","windowResized"],"mappings":";;AAAA,IAAIA,QAAQ,EAAZ;AACA,IAAIC,QAAQ,CAAZ;AACA,IAAIC,eAAe,CAAnB;AACA,IAAIC,uBAAuB,CAA3B;AACA,IAAIC,YAAY,CAAhB;AACA,IAAIC,YAAY,IAAIC,EAAJ,CAAOC,SAAP,CAAhB;;AAEA,SAASC,KAAT,GAAiB;AACbC,cAAU,EAAV;AACAC,cAAUC,GAAV;AACAC,aAASC,MAAT;AACAC;AACA,QAAIC,SAASC,aAAa,GAAb,EAAkB,GAAlB,CAAb;;AAEAD,WAAOE,MAAP,CAAc,gBAAd;;AAEAC,WAAOC,MAAP;;AAEA,SAAI,IAAIC,WAAW,CAAnB,EAAsBA,WAAWC,YAAYC,UAAZ,CAAuBC,SAAxD,EAAmEH,UAAnE,EAA+E;AAC3E,YAAII,MAAM,IAAIC,GAAJ,EAAV;;AAEAD,YAAIE,MAAJ,GAAaF,IAAIG,QAAJ,GAAeN,YAAYC,UAAZ,CAAuBM,cAAnD;AACAJ,YAAIK,WAAJ,CAAgBL,IAAIM,IAApB;AACAT,oBAAYC,UAAZ,CAAuBS,cAAvB,IAAyC,CAAzC;;AAEAP,YAAIQ,SAAJ,GAAgBC,KAAKC,MAAL,MAAiB,GAAjC;AACH;;AAED,SAAI,IAAIC,aAAa,CAArB,EAAwBA,aAAad,YAAYC,UAAZ,CAAuBc,WAA5D,EAAyED,YAAzE,EAAuF;AACnF,YAAIE,KAAJ;AACH;;AAEDC,YAAQC,KAAR,CAAcC,IAAd;AACAF,YAAQC,KAAR,CAAcE,MAAd;;AAEAC,WAAOC,EAAP,CAAU,UAAV,EAAsB,UAASC,KAAT,EAAgB;AAClC,YAAIC,MAAM7C,MAAM8C,SAAN,CAAgB,UAASC,IAAT,EAAe;AACrC,mBAAOA,KAAKC,IAAL,IAAa,KAApB;AACH,SAFS,CAAV;;AAIA,YAAGH,MAAM,CAAT,EAAY;AACRA,kBAAM7C,MAAMiD,MAAZ;AACH;;AAEDjD,cAAMkD,MAAN,CAAaL,GAAb,EAAkB,CAAlB,EAAqBD,KAArB;AACH,KAVD;;AAYAF,WAAOC,EAAP,CAAU,mBAAV,EAA+B,UAASQ,IAAT,EAAe;AAC1CnD,cAAMoD,IAAN,CAAWD,IAAX;AACH,KAFD;;AAIAT,WAAOC,EAAP,CAAU,kBAAV,EAA8B,YAAW;AACrC,aAAI,IAAIU,SAAR,IAAqBC,MAArB,EAA6B;AACzB,gBAAIH,OAAOG,OAAOD,SAAP,CAAX;;AAEA,gBAAGF,KAAKI,aAAL,MAAwBJ,KAAKK,EAAL,IAAWC,SAASC,SAA/C,EAA0D;AACtDhB,uBAAOiB,OAAP,CAAe,mBAAf,EAAoCR,IAApC;AACH;AACJ;AACJ,KARD;;AAUAT,WAAOC,EAAP,CAAU,gBAAV,EAA4B,YAAW;AACnC3C,gBAAQA,MAAM4D,MAAN,CAAa,UAASC,IAAT,EAAe;AAChC,mBAAOA,KAAKb,IAAL,IAAa,MAApB;AACH,SAFO,CAAR;AAGH,KAJD;;AAMAN,WAAOC,EAAP,CAAU,UAAV,EAAsB,YAAW;AAC7BvC,oBAAY,GAAZ;AACH,KAFD;;AAKAsC,WAAOC,EAAP,CAAU,YAAV,EAAwB,YAAW;AAC/BvC,oBAAY,CAAC,CAAb;AACH,KAFD;AAGH;;AAED,SAAS0D,aAAT,GAAyB;AACrB5C,WAAOC,MAAP;AACH","file":"setup.js","sourcesContent":["var queue = []\nvar timer = 1;\nvar daytimeCycle = 1;\nvar backgroundBrightness = 0;\nvar brightDir = 0;\nvar staticMap = new p5(renderMap)\n\nfunction setup() {\n    frameRate(60)\n    colorMode(HSB)\n    rectMode(CENTER)\n    noStroke()\n    var canvas = createCanvas(500, 500)\n\n    canvas.parent('canvas-wrapper');\n\n    resize(window)\n\n    for(var carIndex = 0; carIndex < environment.simulation.carAmount; carIndex++) {\n        var car = new Car()\n\n        car.charge = car.capacity * environment.simulation.carChargeLimit\n        car.enteredCity(car.home)\n        environment.simulation.totalCarCharge += 1\n\n        car.isSlacker = Math.random() >= 0.1\n    }\n\n    for(var truckIndex = 0; truckIndex < environment.simulation.truckAmount; truckIndex++) {\n        new Truck()\n    }\n\n    console.table(cars)\n    console.table(trucks)\n\n    Events.on('carStuck', function(wroom) {\n        var pos = queue.findIndex(function(elem) {\n            return elem.type != 'car'\n        })\n\n        if(pos < 0) {\n            pos = queue.length\n        }\n\n        queue.splice(pos, 0, wroom);\n    })\n\n    Events.on('cityNeedsCharging', function(city) {\n        queue.push(city);\n    })\n\n    Events.on('nightChargeStart', function() {\n        for(var cityIndex in cities) {\n            var city = cities[cityIndex];\n\n            if(city.needsCharging() && city.id != cityDict.Stuttgart) {\n                Events.trigger('cityNeedsCharging', city)\n            }\n        }\n    })\n\n    Events.on('nightChargeEnd', function() {\n        queue = queue.filter(function(item) {\n            return item.type != 'city'\n        })\n    })\n\n    Events.on('nightEnd', function() {\n        brightDir = 0.3\n    })\n\n\n    Events.on('nightStart', function() {\n        brightDir = -1\n    })\n}\n\nfunction windowResized() {\n    resize(window)\n}\n"]}