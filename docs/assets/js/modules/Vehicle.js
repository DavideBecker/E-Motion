"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}(),Vehicle=function(){function t(){_classCallCheck(this,t),this.inCity=!0,this.isDriving=!1,this.isStuck=!1,this.moveStack=[],this.position=createVector(0,0),this.velocity=createVector(0,0),this.capacity=1,this.charge=1,this.dischargeSpeed=.009,this.isSlacker=!1}return _createClass(t,[{key:"getChargePercentage",value:function(){return this.charge/this.capacity}},{key:"fancyPath",value:function(){var t=Nodes.getRandomNode();return graph.findShortestPath(this.location.id,t.id).concat(graph.findShortestPath(t.id,this.target.id))}},{key:"fastestPath",value:function(){return graph.findShortestPath(this.location.id,this.target.id)}},{key:"driveTo",value:function(t,i){this.whenTargetIsReached=i,this.location.id!=t.id?(this.target=t,this.isSlacker?this.moveStack=this.fancyPath():this.moveStack=this.fastestPath(),this.isDriving=!0,this.inCity=!1,this.toNextNode()):i&&i()}},{key:"stop",value:function(){this.isDriving=!1,this.velocity.set(0,0),this.next&&(this.location=this.next)}},{key:"toNextNode",value:function(){if(this.next=Nodes.getById(this.moveStack.shift()),this.next&&!this.isStuck){var t=createVector(this.next.x-this.position.x,this.next.y-this.position.y),i=dist(this.position.x,this.position.y,this.next.x,this.next.y);this.velocity=t.div(2*i)}else this.stop(),this.inCity=!0,this.location=this.target,this.target.isCity&&"car"==this.type&&this.enteredCity(this.target),this.whenTargetIsReached&&this.whenTargetIsReached()}},{key:"reachedNode",value:function(){return dist(this.position.x,this.position.y,this.next.x,this.next.y)<=1}},{key:"updatePosition",value:function(){this.isStuck||(this.position.add(this.velocity),this.isDriving?("car"==this.type&&(this.charge-=this.dischargeSpeed,environment.simulation.totalCarCharge-=this.dischargeSpeed),this.charge<=0&&(this.charge=0,this.location=this.next,this.isStuck=!0,Events.trigger("carStuck",this)),this.reachedNode()&&this.toNextNode()):this.stop())}},{key:"enteredCity",value:function(t){t.parkedCars.push(this),t.updateAverageCharge(this.getChargePercentage()),this.inCity=!0}},{key:"leftCity",value:function(t){t.parkedCars.splice(t.parkedCars.indexOf(this),1),t.updateAverageCharge(-this.getChargePercentage()),this.inCity=!1}},{key:"highlight",value:function(){this.render=function(){fill("#FF0000"),rect(this.position.x*environment.scale,this.position.y*environment.scale,50,50)}}}]),t}();
//# sourceMappingURL=Vehicle.js.map
